# Отчет по 2 лабораторной работе. Маковеева Анастасия 22ПИ-3

## Постановка задачи
> Необходимо в ранее созданный компонент используя приемы программирования включение/агрегирование добавить компонент(-ы) калькулятора, выполняющий(-ие) операции сложения, вычитания, деления и умножения.

## Изменения в компоненте:
- Расширение структуры компонента EcoLab1, изменение методов CEcoLab1_QueryInterface, createCEcoLab1, deleteCEcoLab1

- Расширена поддержка запросов интерфейсов IEcoCalculatorX и IEcoCalculatorY

- Реализована стратегия выбора компонентов калькуляторов по приоритету:

- Сначала попытка получить компонент E (агрегирует B), затем компонент D (включает A), затем компонент B, и компонент A

## Тестирование:
<img width="1477" height="701" alt="image" src="https://github.com/user-attachments/assets/69201168-462c-474e-a635-0a5a5859e541" />

### ТЕСТ 1: Проверка базового функционала линейной алгебры
Цель: Демонстрация работы оригинального интерфейса IEcoLinearAlgebra через QueryInterface

Процедура:

Запрос интерфейса IEcoLinearAlgebra у основного компонента

Создание вектора размером 3 элемента

Заполнение вектора значениями 1.0, 2.0, 3.0

Создание диагональной матрицы из вектора

Вывод результатов

### ТЕСТ 2: Проверка агрегирования IEcoCalculatorX
Цель: Демонстрация получения интерфейса калькулятора через агрегирование

Процедура:

Запрос интерфейса IEcoCalculatorX у основного компонента

Проверка успешности агрегирования

Тестирование операции сложения (3 + 5)

Тестирование операции вычитания (10 - 4)

Проверка корректности управления памятью

### ТЕСТ 3: Проверка агрегирования IEcoCalculatorY
Цель: Демонстрация получения интерфейса калькулятора для операций умножения и деления

Процедура:

Запрос интерфейса IEcoCalculatorY у основного компонента

Проверка успешности агрегирования

Тестирование операции умножения (3 * 5)

Тестирование операции деления (15 / 3)

Проверка корректности освобождения ресурсов

### ТЕСТ 4: Демонстрация свойств интерфейсов COM
> Необходимо продемонстрировать свойства интерфейсов, показать, что через любой указатель на интерфейс можно получить указатель на любой другой запрашиваемый интерфейс используя метод QueryInterface.

Цель: Проверка запросов интерфейсов 

Процесс тестирования:

Получение интерфейса IEcoCalculatorX из основного компонента

Из интерфейса IX получение интерфейса IY через QueryInterface

Из интерфейса IY обратное получение интерфейса IX

Проверка функциональной эквивалентности полученных интерфейсов

Попытка получения исходного интерфейса IEcoLab1 из агрегированного интерфейса

## Результаты:
- Компонент EcoLab1 теперь поддерживает агрегирование и включение всех компонентов, обеспечена обратная совместимость с существующим функционалом линейной алгебры и реализован единый механизм доступа ко всем интерфейсам через QueryInterface и проверка функциональности калькуляторов.
